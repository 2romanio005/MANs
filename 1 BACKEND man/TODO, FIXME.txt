TODO: доделать чтото
FIXME: прикаких то условиях неправильно работает