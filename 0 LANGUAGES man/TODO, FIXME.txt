TODO: доделать что-то
FIXME: прикаких то условиях неправильно работает